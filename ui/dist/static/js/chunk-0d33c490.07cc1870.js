(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0d33c490"],{"753c":function(t,e,n){"use strict";n.r(e);var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("clusterbar",{attrs:{titleName:t.titleName,nameFunc:t.nameSearch,createFunc:t.createClusterDialog,createDisplay:"添加集群"}}),n("div",{ref:"tableCot",staticClass:"dashboard-container"},[n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"table-fix",staticStyle:{width:"100%"},attrs:{data:t.clusters,"tooltip-effect":"dark","max-height":t.maxHeight,"cell-style":t.cellStyle,"default-sort":{prop:"name"},"row-key":"name"}},[n("el-table-column",{attrs:{prop:"name",label:"名称","show-overflow-tooltip":""}}),n("el-table-column",{attrs:{prop:"create_time",label:"创建时间","show-overflow-tooltip":""}}),n("el-table-column",{attrs:{prop:"status",label:"状态","min-width":"34%","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",{style:{color:"Connect"===e.row.status?"#409EFF":"#F56C6C"}},[t._v(" "+t._s(e.row.status)+" "),"Connect"===e.row.status?[n("svg-icon",{staticStyle:{width:"1.3em",height:"1.3em","line-height":"40px","vertical-align":"-0.25em"},attrs:{"icon-class":"correct"}})]:[n("svg-icon",{staticStyle:{width:"1.3em",height:"1.3em","line-height":"40px","vertical-align":"-0.25em"},attrs:{"icon-class":"wrong"}})]],2)]}}])}),n("el-table-column",{attrs:{label:"",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-dropdown",{attrs:{size:"medium"}},[n("el-link",{attrs:{underline:!1}},[n("svg-icon",{staticStyle:{width:"1.3em",height:"1.3em"},attrs:{"icon-class":"operate"}})],1),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},["Pending"===e.row.status?n("el-dropdown-item",{nativeOn:{click:function(n){n.preventDefault(),t.clusterConnectToken=e.row.token,t.clusterConnectDialog=!0}}},[n("svg-icon",{staticStyle:{width:"1.3em",height:"1.3em","line-height":"40px","vertical-align":"-0.25em"},attrs:{"icon-class":"link"}}),n("span",{staticStyle:{"margin-left":"5px"}},[t._v("连接")])],1):t._e(),n("el-dropdown-item",{nativeOn:{click:function(n){return n.preventDefault(),t.deleteClusters([{name:e.row.name}])}}},[n("svg-icon",{staticStyle:{width:"1.3em",height:"1.3em","line-height":"40px","vertical-align":"-0.25em"},attrs:{"icon-class":"delete"}}),n("span",{staticStyle:{"margin-left":"5px"}},[t._v("删除")])],1)],1)],1)]}}])})],1)],1),n("div",[n("el-dialog",{attrs:{title:"创建集群",visible:t.createClusterFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(e){t.createClusterFormVisible=e}}},[n("el-form",{attrs:{model:t.form}},[n("el-form-item",{attrs:{label:"集群名称"}},[n("el-input",{attrs:{autocomplete:"off"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1)],1),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(e){t.createClusterFormVisible=!1}}},[t._v("取 消")]),n("el-button",{attrs:{type:"primary"},on:{click:t.handleCreateCluster}},[t._v("确 定")])],1)],1)],1),n("el-dialog",{attrs:{title:"集群导入",visible:t.clusterConnectDialog,"close-on-click-modal":!1},on:{"update:visible":function(e){t.clusterConnectDialog=e}}},[n("div",{staticStyle:{"font-size":"15px"}},[t._v("请在现有Kubernetes集群上运行下面的kubeclt命令，以连接OpenSpace平台：")]),n("div",{staticStyle:{"margin-top":"15px"}},[n("el-tag",{staticStyle:{"font-size":"14px","border-radius":"4px"},attrs:{type:"info"}},[t._v(" "+t._s(t.copyCluster)+" ")])],1),n("div",{staticStyle:{"font-size":"13px","margin-top":"8px",color:"#e6a23c"}},[t._v(" *注意：请将上述访问地址"+t._s(this.locationAddr)+"换为Kubernetes集群可以访问的地址。 ")]),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary"},on:{click:function(e){t.clusterConnectDialog=!1}}},[t._v("确 定")])],1)])],1)},a=[],i=(n("99af"),n("4de4"),n("b0c0"),n("61b2")),s=n("7ea2"),l=n("5c96"),r={name:"SettingsCluster",components:{Clusterbar:i["a"]},data:function(){return{titleName:["Clusters"],search_name:"",cellStyle:{border:0},maxHeight:window.innerHeight-150,loading:!0,clusters:[],createClusterFormVisible:!1,clusterConnectDialog:!1,clusterConnectToken:"",form:{name:""},locationAddr:window.location.origin}},created:function(){this.fetchData()},mounted:function(){var t=this;window.onresize=function(){return function(){var e=window.innerHeight-150;console.log(e),t.maxHeight=e}()}},watch:{clusterWatch:function(t){if(t){var e=t.resource.name;if("add"===t.event)this.clusters.push(t.resource);else if("update"===t.event)for(var n in this.clusters){var o=this.clusters[n];if(o.name===e){this.$set(this.clusters,n,t.resource);break}}else"delete"===t.event&&(this.clusters=this.clusters.filter((function(t){var n=t.name;return n!==e})))}}},computed:{copyCluster:function(){return"curl -sk ".concat(this.locationAddr,"/v1/import/").concat(this.clusterConnectToken," | kubectl apply -f -")},clusterWatch:function(){return this.$store.getters["ws/globalClusterWatch"]}},methods:{fetchData:function(){var t=this;this.loading=!0,Object(s["f"])().then((function(e){t.loading=!1,t.clusters=e.data})).catch((function(){t.loading=!1}))},nameSearch:function(t){this.search_name=t},createClusterDialog:function(){this.createClusterFormVisible=!0},handleCreateCluster:function(){var t=this;console.log(this.form.name),this.form.name?Object(s["c"])(this.form).then((function(e){l["Message"].success("集群添加成功"),t.createClusterFormVisible=!1,t.loading=!1,t.fetchData(),t.clusterConnectToken=e.data.token,t.clusterConnectDialog=!0})).catch((function(){t.loading=!1})):l["Message"].error("集群名称不能为空！")},deleteClusters:function(t){var e=this;t.length<=0?l["Message"].error("请选择要删除的集群"):Object(s["e"])(t).then((function(t){e.fetchData()})).catch((function(t){console.log(t)}))},onCopy:function(t){l["Message"].success("复制成功")},onError:function(t){}}},c=r,u=(n("987c"),n("2877")),d=Object(u["a"])(c,o,a,!1,null,"58d5e042",null);e["default"]=d.exports},"8df48":function(t,e,n){},"987c":function(t,e,n){"use strict";var o=n("8df48"),a=n.n(o);a.a}}]);